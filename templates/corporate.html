<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cota√ß√µes Corporativo | R3 Viagens</title>
    <link
      rel="icon"
      href="{{ url_for('static', filename='assets/icone.png') }}"
      type="image/png"
    />

    <link
      href="https://fonts.googleapis.com/css2?family=Saira:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <meta
      http-equiv="Cache-Control"
      content="no-store, no-cache, must-revalidate"
    />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />

    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Saira", sans-serif;
      }

      body {
        background: #f5f6fa;
      }

      /* ==========================
       SIDEBAR ‚Äì FIGMA
    ========================== */
      .sidebar {
        width: 288px;
        height: 100vh;
        background: #00245a;
        padding: 32px 24px;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 24px;
        position: fixed;
        top: 0;
        left: 0;
      }

      .sidebar-logo img {
        width: 90px;
        height: 90px;
      }

      .sidebar-menu {
        width: 100%;
        display: flex;
        flex-direction: column;
        gap: 4px;
      }

      /* ==========================
       DROPDOWN (COTA√á√ïES)
    ========================== */
      .dropdown {
        width: 100%;
        background: #ab1e22;
        border-radius: 8px;
        padding: 12px;
        cursor: pointer;
        display: flex;
        flex-direction: column;
        gap: 12px;
      }

      .dropdown-header {
        display: flex;
        align-items: center;
        gap: 8px;
        position: relative;
        color: #ffffff;
      }

      .dropdown-header-left {
        flex: 1;
        display: flex;
        gap: 8px;
        align-items: center;
      }

      .dropdown-icon {
        width: 24px;
        height: 24px;
      }

      .dropdown-arrow {
        width: 20px;
        height: 20px;
        position: absolute;
        right: 5px;
        top: 40%;
        transform: translateY(-40%);
        transition: transform 0.2s ease;
      }

      .dropdown.open .dropdown-arrow {
        transform: rotate(180deg);
      }

      .submenu {
        display: none;
        flex-direction: column;
        gap: 8px;
        margin-left: 4px;
        margin-top: 4px;
      }

      .dropdown.open .submenu {
        display: flex;
      }

      .submenu-item {
        padding: 12px;
        border-radius: 6px;
        font-size: 14px;
        color: white;
        cursor: pointer;
        transition: background 0.2s;
      }

      .submenu-item:hover {
        background: rgba(255, 255, 255, 0.2);
      }

      /* ==========================
       MENU ITEM NORMAL
    ========================== */
      .menu-item {
        width: 100%;
        padding: 12px;
        border-radius: 6px;
        color: white;
        text-decoration: none;
        font-size: 14px;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 8px;
        transition: background 0.2s;
      }

      .menu-item:hover {
        background: rgba(255, 255, 255, 0.15);
      }

      /* ==========================
       TOPBAR SUPERIOR
    ========================== */
      .topbar {
        position: fixed;
        top: 0;
        left: 288px;
        width: calc(100% - 288px);
        height: 70px;
        background: #ffffff;
        display: flex;
        justify-content: flex-end;
        align-items: center;
        padding: 0 40px;
        gap: 24px;
        border-bottom: 1px solid #e5e5e5;
        z-index: 50;
      }

      .topbar-user {
        display: flex;
        align-items: center;
        gap: 12px;
      }

      .topbar-user span {
        font-size: 16px;
        color: #333;
        font-weight: 500;
      }

      .topbar-avatar {
        width: 42px;
        height: 42px;
        border-radius: 50%;
        object-fit: cover;
        border: 2px solid #ddd;
      }

      .topbar-logout {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 15px;
        color: #555;
        cursor: pointer;
        text-decoration: none;
        transition: 0.2s;
      }

      .topbar-logout:hover {
        color: #ab1e22;
      }

      .topbar-logout svg {
        width: 20px;
        height: 20px;
      }

      .topbar-divider {
        width: 1px;
        height: 40px;
        background: #ccd3e0;
        margin: 0 18px;
      }

      /* ==========================
       MAIN CONTENT
    ========================== */
      .home-container {
        margin-left: 288px;
        padding: 120px 40px 40px 40px; /* espa√ßo para a topbar */
      }

      .tag {
        background-color: #ab1e22;
        color: white;
        font-size: 13px;
        padding: 6px 12px;
        border-radius: 30px;
        font-weight: 500;
      }

      .submenu-item {
        text-decoration: none; /* Remove o underline */
      }

      .dropdown-option {
        padding: 10px 16px;
        cursor: pointer;
        color: #4d5568;
        border-bottom: 1px solid #eee;
      }

      .dropdown-option:hover {
        background-color: #f5f5f5;
      }

      .tag-cotacao {
        background-color: #ab1e22;
        color: white;
        padding: 6px 12px;
        border-radius: 30px;
        font-size: 13px;
        font-weight: 500;
        display: flex;
        align-items: center;
        gap: 6px;
      }

      .tag-cotacao span {
        cursor: pointer;
        font-weight: bold;
      }
    </style>
  </head>

  <body>
    <!-- SIDEBAR -->
    <aside class="sidebar">
      <div class="sidebar-logo">
        <img
          src="{{ url_for('static', filename='assets/logo_r3.png') }}"
          alt="Logo R3"
        />
      </div>

      <nav class="sidebar-menu">
        {% if menu.cotacoes %}
        <div class="dropdown" onclick="toggleDropdown()">
          <div class="dropdown-header">
            <div class="dropdown-header-left">
              <div class="dropdown-icon">
                <!-- √çcone de Cota√ß√µes -->
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  fill="none"
                >
                  <path
                    d="M12 6.75V8.25"
                    stroke="white"
                    stroke-width="1.5"
                    stroke-linecap="round"
                  />
                  <path
                    d="M12 15.75V17.25"
                    stroke="white"
                    stroke-width="1.5"
                    stroke-linecap="round"
                  />
                  <path
                    d="M12 21c4.97 0 9-4.03 9-9s-4.03-9-9-9-9 4.03-9 9 4.03 9 9 9z"
                    stroke="white"
                    stroke-width="1.5"
                  />
                  <path
                    d="M9.75 15.75h3.375c.497 0 .974-.197 1.325-.549.352-.351.55-.828.55-1.326 0-.498-.198-.975-.55-1.326-.351-.352-.828-.549-1.325-.549h-2.25c-.497 0-.974-.198-1.325-.55A1.87 1.87 0 0 1 9 10.125c0-.498.198-.975.55-1.326.351-.352.828-.549 1.325-.549h3.375"
                    stroke="white"
                    stroke-width="1.5"
                  />
                </svg>
              </div>
              Cota√ß√µes
            </div>
            <div class="dropdown-arrow">
              <svg width="15" height="10" fill="none">
                <path d="M1 1l4 4 4-4" stroke="white" stroke-width="1.5" />
              </svg>
            </div>
          </div>

          <div class="submenu">
            <a class="submenu-item" href="{{ url_for('cotacoes_lazer') }}"
              >Lazer</a
            >
            <a class="submenu-item" href="{{ url_for('cotacoes_corporativo') }}"
              >Corporativo</a
            >
          </div>
        </div>
        {% endif %} {% if menu.relatorios %}
        <a class="menu-item" href="{{ url_for('relatorios') }}">
          <div class="menu-icon">
            <!-- √çcone de relat√≥rios -->
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              fill="none"
            >
              <path
                d="M9 12h6M9 15h6"
                stroke="white"
                stroke-width="1.5"
                stroke-linecap="round"
              />
              <path
                d="M4.5 3.75h15V18.75a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 18.75V3.75z"
                stroke="white"
                stroke-width="1.5"
              />
              <path
                d="M7.5 2.25v3M12 2.25v3M16.5 2.25v3"
                stroke="white"
                stroke-width="1.5"
              />
            </svg>
          </div>
          Relat√≥rios
        </a>
        {% endif %} {% if menu.usuarios %}
        <a class="menu-item" href="{{ url_for('usuarios') }}">
          <div class="menu-icon">
            <!-- √çcone de Usu√°rios -->
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              fill="none"
            >
              <path
                d="M7.875 15A4.875 4.875 0 1 0 7.875 5.25a4.875 4.875 0 0 0 0 9.75z"
                stroke="white"
                stroke-width="1.5"
              />
              <path
                d="M1 18.75c1.5-2.25 4.5-3.75 6.875-3.75 2.375 0 5.375 1.5 6.875 3.75"
                stroke="white"
                stroke-width="1.5"
              />
              <path
                d="M16.125 15c2.25 0 4.875 1.5 6.375 3.75"
                stroke="white"
                stroke-width="1.5"
              />
              <path
                d="M14.5 5.5a5.5 5.5 0 0 1 5 9"
                stroke="white"
                stroke-width="1.5"
              />
            </svg>
          </div>
          Usu√°rios
        </a>
        {% endif %}
      </nav>
    </aside>

    <!-- ==============================
         TOPBAR SUPERIOR
    ============================== -->
    <header class="topbar">
      <div class="topbar-user">
        <span>Bem-vinda, {{ session['user'] }}!</span>

        <!-- Avatar tempor√°rio -->
        <a href="{{ url_for('perfil') }}" class="topbar-avatar-link">
          <img
            src="{{ url_for('static', filename=profile_pic) }}"
            class="topbar-avatar"
            alt="Foto do usu√°rio"
          />
        </a>

        <!-- BARRINHA DIVIS√ìRIA -->
        <div class="topbar-divider"></div>
      </div>

      <a href="{{ url_for('logout') }}" class="topbar-logout">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
        >
          <g clip-path="url(#clip0_3_163)">
            <path
              d="M10.5 3.75H4.5V20.25H10.5"
              stroke="#969696"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M10.5 12H21"
              stroke="#969696"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
            <path
              d="M17.25 8.25L21 12L17.25 15.75"
              stroke="#969696"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </g>
          <defs>
            <clipPath id="clip0_3_163">
              <rect width="24" height="24" fill="white" />
            </clipPath>
          </defs>
        </svg>
        Sair
      </a>
    </header>

    <!-- ==============================
         CONTE√öDO DA HOME
    ============================== -->
    <div class="home-container">
      <!-- Breadcrumb -->
      <p style="font-size: 14px; color: #777; margin-bottom: 4px">
        Cota√ß√µes > Corporativo
      </p>

      <!-- T√≠tulo da p√°gina -->
      <h1
        style="
          font-size: 24px;
          font-weight: 700;
          color: #1c1c1c;
          margin-bottom: 32px;
        "
      >
        Cota√ß√µes Corporativo
      </h1>

      <form
        action="{{ url_for('send_email') }}"
        method="POST"
        style="
          background: #fff;
          padding: 32px;
          border-radius: 12px;
          box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
          display: flex;
          flex-wrap: wrap;
          gap: 24px;
        "
      >
        <!-- Nome do Cliente -->
        <div style="flex: 1 1 45%">
          <label style="display: block; margin-bottom: 8px; font-weight: 600"
            >Nome do cliente *</label
          >
          <input
            type="text"
            name="nome_cliente"
            placeholder="Nome do cliente"
            style="
              width: 100%;
              padding: 12px;
              border: 1.5px solid #ab1e22;
              border-radius: 8px;
              background-color: #f0f0f0;
            "
            required
          />
        </div>

        <!-- E-mail do Cliente -->
        <div style="flex: 1 1 45%">
          <label style="display: block; margin-bottom: 8px; font-weight: 600"
            >E-mail do Cliente *</label
          >
          <input
            type="email"
            name="email_cliente"
            placeholder="E-mail do Cliente"
            style="
              width: 100%;
              padding: 12px;
              border: 1.5px solid #ab1e22;
              border-radius: 8px;
              background-color: #f0f0f0;
            "
            required
          />
        </div>

        <!-- Campo "Selecione as cota√ß√µes" -->
        <div style="flex: 1 1 93%">
          <label
            style="
              display: block;
              margin-bottom: 8px;
              font-weight: 600;
              color: #000000;
            "
            >Selecione as cota√ß√µes *</label
          >

          <div id="cotacoes-dropdown" style="position: relative">
            <div
              onclick="toggleDropdownCOTACOES()"
              style="
                background-color: #f0f0f0;
                border: 1.5px solid #ab1e22;
                border-radius: 8px;
                padding: 12px;
                cursor: pointer;
                display: flex;
                justify-content: space-between;
                align-items: center;
              "
            >
              <span style="color: #4d5568">Clique para selecionar</span>
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                <path d="M6 9L12 15L18 9" stroke="#4D5568" stroke-width="2" />
              </svg>
            </div>

            <div
              id="opcoes-cotacoes"
              style="
                display: none;
                position: absolute;
                background: #fff;
                border: 1px solid #ccc;
                border-radius: 8px;
                margin-top: 4px;
                width: 100%;
                z-index: 99;
              "
            >
              <div class="dropdown-option" onclick="selecionarOpcao('A√©reo')">
                A√©reo
              </div>
              <div class="dropdown-option" onclick="selecionarOpcao('Hotel')">
                Hotel
              </div>
              <div class="dropdown-option" onclick="selecionarOpcao('Loca√ß√£o')">
                Loca√ß√£o
              </div>
              <div
                class="dropdown-option"
                onclick="selecionarOpcao('Seguro Viagem')"
              >
                Seguro Viagem
              </div>
              <div
                class="dropdown-option"
                onclick="selecionarOpcao('Passeios')"
              >
                Passeios
              </div>
              <div
                class="dropdown-option"
                onclick="selecionarOpcao('Transfers')"
              >
                Transfers
              </div>
              <div class="dropdown-option" onclick="selecionarOpcao('Trens')">
                Trens
              </div>
              <div class="dropdown-option" onclick="selecionarOpcao('Outros')">
                Outros
              </div>
            </div>
          </div>

          <div
            id="tags-cotacoes"
            style="margin-top: 12px; display: flex; gap: 8px; flex-wrap: wrap"
          ></div>

          <input
            type="hidden"
            name="cotacoesSelecionadas"
            id="cotacoesSelecionadas"
          />
        </div>

        <!-- Tipo de Viagem -->
        <div style="flex: 1 1 45%">
          <label style="display: block; margin-bottom: 8px; font-weight: 600"
            >Tipo de viagem: *</label
          >
          <div style="display: flex; gap: 24px; padding-top: 6px">
            <label
              ><input
                type="radio"
                name="tipo_viagem"
                value="Internacional"
                required
              />
              Internacional</label
            >
            <label
              ><input
                type="radio"
                name="tipo_viagem"
                value="Nacional"
                required
              />
              Nacional</label
            >
          </div>
        </div>

        <!-- Empresas -->

        <div style="flex: 1 1 45%; position: relative">
          <label
            style="
              display: block;
              margin-bottom: 8px;
              font-weight: 600;
              color: #000000;
            "
            >Empresas *</label
          >

          <select
            id="empresa"
            name="empresa"
            required
            style="
              width: 100%;
              padding: 12px 40px 12px 12px;
              border: 1.5px solid #ab1e22;
              border-radius: 8px;
              background-color: #f0f0f0;
              color: #000000;
              appearance: none;
              -webkit-appearance: none;
              -moz-appearance: none;
              font-size: 15px;
            "
          >
            <option value="">Selecione</option>
            <option value="ABMRA">ABMRA</option>
            <option value="ACTIONOOH">ACTIONOOH</option>
            <option value="ADILIS">ADILIS</option>
            <option value="AGENCIANUTS">AGENCIANUTS</option>
            <option value="ALEX DARC PRODUCOES">ALEX DARC PRODUCOES</option>
            <option value="ALIBRA">ALIBRA</option>
            <option value="ALIBRA FILIAL">ALIBRA FILIAL</option>
            <option value="AMORIM CORTINAS">AMORIM CORTINAS</option>
            <option value="ANNA REGINA PIRES">ANNA REGINA PIRES</option>
            <option value="ANPUH">ANPUH</option>
            <option value="APMP">APMP</option>
            <option value="ASTORIA">ASTORIA</option>
            <option value="BANCO ARTICO">BANCO ARTICO</option>
            <option value="BEAUTY SOLUTIONS">BEAUTY SOLUTIONS</option>
            <option value="BELKISS AZEVEDO">BELKISS AZEVEDO</option>
            <option value="BOURBON STREET MUSIC CLUB">
              BOURBON STREET MUSIC CLUB
            </option>
            <option value="BRASILEIRISSIMA - SSA">BRASILEIRISSIMA - SSA</option>
            <option value="BRASILETROS">BRASILETROS</option>
            <option value="BRASIL A√áOS">BRASIL A√áOS</option>
            <option value="CALLFLEX">CALLFLEX</option>
            <option value="CARLOS HENRIQUE DELMONACO">
              CARLOS HENRIQUE DELMONACO
            </option>
            <option value="CARPA PATRIMONIAL">CARPA PATRIMONIAL</option>
            <option value="CBMAQ">CBMAQ</option>
            <option value="CENTURY PROJETOS E CONSTRUCOES">
              CENTURY PROJETOS E CONSTRUCOES
            </option>
            <option value="CHEIL BRAZIL">CHEIL BRAZIL</option>
            <option value="CLARKE AGENCY">CLARKE AGENCY</option>
            <option value="CONNECT SERVICE">CONNECT SERVICE</option>
            <option value="CONAM">CONAM</option>
            <option value="CORRETORA BROKERS">CORRETORA BROKERS</option>
            <option value="COTTON">COTTON</option>
            <option value="CYCLOPET">CYCLOPET</option>
            <option value="DMTA BRASIL">DMTA BRASIL</option>
            <option value="DIVERXIA BRASIL">DIVERXIA BRASIL</option>
            <option value="ECOM ENERGIA">ECOM ENERGIA</option>
            <option value="EMBRASERV">EMBRASERV</option>
            <option value="EPPENDORF DO BRASIL">EPPENDORF DO BRASIL</option>
            <option value="ETM ENGENHARIA">ETM ENGENHARIA</option>
            <option value="EUROQUADROS FILIAL SC">EUROQUADROS FILIAL SC</option>
            <option value="FACULDADE SANTA MARCELINA - ITAQUERA">
              FACULDADE SANTA MARCELINA - ITAQUERA
            </option>
            <option value="FESP SP">FESP SP</option>
            <option value="FERNANDO CALIXTO OLIVEIRA">
              FERNANDO CALIXTO OLIVEIRA
            </option>
            <option value="FFC SERVICOS">FFC SERVICOS</option>
            <option value="FINOBRASA">FINOBRASA</option>
            <option value="FIVES BRAZIL">FIVES BRAZIL</option>
            <option value="FRANCOIS TACK">FRANCOIS TACK</option>
            <option value="GEOFIX">GEOFIX</option>
            <option value="GLOSSYE - EVENTOS">GLOSSYE - EVENTOS</option>
            <option value="GRUPO ACELERADOR EDUCACAO">
              GRUPO ACELERADOR EDUCACAO
            </option>
            <option value="GRUPO GSH">GRUPO GSH</option>
            <option value="HARMONIA">HARMONIA</option>
            <option value="HERCO">HERCO</option>
            <option value="HOWDEN RESSEGUROS">HOWDEN RESSEGUROS</option>
            <option value="HSLAW - HASSON SAYEG">HSLAW - HASSON SAYEG</option>
            <option value="IASP">IASP</option>
            <option value="IBF - FILIAL VSA">IBF - FILIAL VSA</option>
            <option value="IBF MATRIZ">IBF MATRIZ</option>
            <option value="IFEP">IFEP</option>
            <option value="IMAGINADORA DESTINOS">IMAGINADORA DESTINOS</option>
            <option value="IMAGINADORA PROPAGANDA E MARKETING LTDA">
              IMAGINADORA PROPAGANDA E MARKETING LTDA
            </option>
            <option value="INFRAPREV">INFRAPREV</option>
            <option value="INICIATIVA VERDE">INICIATIVA VERDE</option>
            <option value="INSTITUTO VOTORANTIM - EVENTOS">
              INSTITUTO VOTORANTIM - EVENTOS
            </option>
            <option value="INVENT">INVENT</option>
            <option value="LEME CONSULTORIA">LEME CONSULTORIA</option>
            <option value="LEGACY CAPITAL">LEGACY CAPITAL</option>
            <option value="LINKANA">LINKANA</option>
            <option value="MAPLE TECNOLOGIA EMPRESARIAL LTDA ME">
              MAPLE TECNOLOGIA EMPRESARIAL LTDA ME
            </option>
            <option value="MARCELLO BAPTISTA DE OLIVEIRA">
              MARCELLO BAPTISTA DE OLIVEIRA
            </option>
            <option value="MARCAS DMG">MARCAS DMG</option>
            <option value="MARCUS LIMA">MARCUS LIMA</option>
            <option value="MBF ALIMENTOS">MBF ALIMENTOS</option>
            <option value="MED SOLUTIONS">MED SOLUTIONS</option>
            <option value="MEDWAY">MEDWAY</option>
            <option value="MDS DOR EVENTOS - ASSESSORIA">
              MDS DOR EVENTOS - ASSESSORIA
            </option>
            <option value="MDS EVENTOS - ASSESSORIA">
              MDS EVENTOS - ASSESSORIA
            </option>
            <option value="MDS INSURE">MDS INSURE</option>
            <option value="MENDES LOPES">MENDES LOPES</option>
            <option value="MINDLAB">MINDLAB</option>
            <option value="MITSUI SEGUROS">MITSUI SEGUROS</option>
            <option value="MOZART RAMOS">MOZART RAMOS</option>
            <option value="MY BUSINESS">MY BUSINESS</option>
            <option value="NEWREST BRASIL">NEWREST BRASIL</option>
            <option value="NEWREST GALEAO">NEWREST GALEAO</option>
            <option value="NRB FASHION COMPANY">NRB FASHION COMPANY</option>
            <option value="PARANOID - LIONS">PARANOID - LIONS</option>
            <option value="PARANOID FILMES">PARANOID FILMES</option>
            <option value="PETROM">PETROM</option>
            <option value="PIRES E GON√áALVES ADVOGADOS">
              PIRES E GON√áALVES ADVOGADOS
            </option>
            <option value="QH CONSULT">QH CONSULT</option>
            <option value="R2 IBF">R2 IBF</option>
            <option value="R2 - FILIAL">R2 - FILIAL</option>
            <option value="R3 - REEMBOLSO INTEGRAL">
              R3 - REEMBOLSO INTEGRAL
            </option>
            <option value="REBUSS BRASIL">REBUSS BRASIL</option>
            <option value="REGINA DUTRA">REGINA DUTRA</option>
            <option value="ROBERTA BARRETO">ROBERTA BARRETO</option>
            <option value="RPH RADIOFARMACIA - FILIAL">
              RPH RADIOFARMACIA - FILIAL
            </option>
            <option value="RPH RADIOFARMACIA MATRIZ">
              RPH RADIOFARMACIA MATRIZ
            </option>
            <option value="RPHPHARMA">RPHPHARMA</option>
            <option value="RPHPHARMA ITUPEVA">RPHPHARMA ITUPEVA</option>
            <option value="SAFETY">SAFETY</option>
            <option value="SAKES">SAKES</option>
            <option value="SANDRO ASSAYAG">SANDRO ASSAYAG</option>
            <option value="SANTA MARCELINA">SANTA MARCELINA</option>
            <option value="SASOL DO BRASIL">SASOL DO BRASIL</option>
            <option value="SERPROS">SERPROS</option>
            <option value="SHOULDER">SHOULDER</option>
            <option value="SICOOB">SICOOB</option>
            <option value="SINSTAL">SINSTAL</option>
            <option value="SIT TRADE">SIT TRADE</option>
            <option value="SOGEDEV">SOGEDEV</option>
            <option value="SOLTEC DESENVOLVIMENTO (ANTIGA POWERTIS)">
              SOLTEC DESENVOLVIMENTO (ANTIGA POWERTIS)
            </option>
            <option value="SOLTEC INDUSTRIAL">SOLTEC INDUSTRIAL</option>
            <option value="SPOT">SPOT</option>
            <option value="SYNERGY AROMAS">SYNERGY AROMAS</option>
            <option value="SYSTUR">SYSTUR</option>
            <option value="TATICA MKT">TATICA MKT</option>
            <option value="TCP">TCP</option>
            <option value="TECGOLD VITORIA">TECGOLD VITORIA</option>
            <option value="TPMB">TPMB</option>
            <option value="TRANSLUTE">TRANSLUTE</option>
            <option value="UELLO">UELLO</option>
            <option value="VALTEC">VALTEC</option>
            <option value="VOAR MAIS">VOAR MAIS</option>
            <option value="VYTTRA DIAGNOSTICOS">VYTTRA DIAGNOSTICOS</option>
            <option value="VYTTRA SERVI√áOS">VYTTRA SERVI√áOS</option>
            <option value="WE PINK">WE PINK</option>
            <option value="WORK ON PEOPLE SERVICOS LTDA">
              WORK ON PEOPLE SERVICOS LTDA
            </option>
            <option value="XPTO VIAGENS">XPTO VIAGENS</option>
          </select>

          <!-- √çcone de seta estilo dropdown -->
          <div
            class="dropdown-arrow"
            style="
              position: absolute;
              right: 10px;
              top: 70%;
              transform: translateY(-50%);
              pointer-events: none;
            "
          >
            <svg width="15" height="10" fill="none">
              <path d="M1 1l4 4 4-4" stroke="#4D5568" stroke-width="1.5" />
            </svg>
          </div>
        </div>

        <!-- Cota√ß√£o em Texto -->

        <div style="flex: 1 1 93%">
          <label
            style="
              display: block;
              margin-bottom: 8px;
              font-weight: 600;
              color: #000000;
            "
          >
            Cole aqui a cota√ß√£o em texto *
          </label>
          <textarea
            id="texto-cotacao"
            name="texto_cotacao"
            rows="5"
            required
            placeholder="Cole aqui a cota√ß√£o..."
            style="
              width: 100%;
              padding: 12px;
              border: 1.5px solid #ab1e22;
              border-radius: 8px;
              background-color: #f0f0f0;
              color: #4d5568;
              font-family: 'Saira', sans-serif;
              font-size: 15px;
            "
          ></textarea>
        </div>

        <!-- Bot√µes -->
        <div
          style="
            grid-column: span 2;
            display: flex;
            justify-content: flex-end;
            gap: 20px;
            margin-top: 5px;
          "
        >
          <!-- BOT√ÉO QUE REPROCESSA O  E-MAIL -->
          <button
            type="button"
            id="btnReprocessar"
            style="
              background: #ab1e22;
              color: white;
              padding: 12px 36px;
              border-radius: 40px;
              font-weight: 600;
              font-size: 15px;
              border: none;
              cursor: pointer;
            "
          >
            Reprocessar
          </button>

          <!-- BOT√ÉO LIMPAR REAL -->
          <button
            type="reset"
            style="
              background: #777;
              color: white;
              padding: 12px 36px;
              border-radius: 40px;
              font-weight: 600;
              font-size: 15px;
              border: none;
              cursor: pointer;
            "
          >
            Limpar
          </button>
        </div>

        <p
          id="mensagem-envio"
          style="margin-top: 16px; font-weight: 600; display: none"
        ></p>
      </form>
    </div>

    <!-- MODAL DE PR√â-VISUALIZA√á√ÉO -->
    <div
      id="modalPreview"
      style="
        display: none;
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.6);
        z-index: 999;
        align-items: center;
        justify-content: center;
      "
    >
      <div
        style="
          background: white;
          width: 90%;
          max-width: 700px;
          border-radius: 12px;
          padding: 24px;
          display: flex;
          flex-direction: column;
          gap: 16px;
        "
      >
        <h2 style="font-size: 20px">Pr√©-visualiza√ß√£o do E-mail</h2>

        <div
          id="previewEmail"
          style="
            background: #f5f5f5;
            padding: 16px;
            border-radius: 8px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
            font-size: 14px;
          "
        ></div>

        <!-- LINHA FINAL COM MENSAGEM + BOT√ïES -->
        <div
          style="
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
            margin-top: 10px;
          "
        >
          <!-- MENSAGEM DE STATUS -->
          <span id="mensagemModal" style="font-weight: 600"></span>

          <!-- BOT√ïES -->
          <div style="display: flex; gap: 12px">
            <button
              onclick="fecharModal()"
              style="
                padding: 10px 24px;
                border-radius: 30px;
                border: none;
                background: #777;
                color: white;
                cursor: pointer;
              "
            >
              Fechar
            </button>

            <button
              id="btnEnviarModal"
              style="
                padding: 10px 24px;
                border-radius: 30px;
                border: none;
                background: #ab1e22;
                color: white;
                font-weight: 600;
                cursor: pointer;
              "
            >
              Enviar E-mail
            </button>
          </div>
        </div>
      </div>
    </div>

    <script>
      function toggleDropdown() {
        document.querySelector(".dropdown").classList.toggle("open");
      }
    </script>

    <script>
      history.pushState(null, "", location.href);
      window.onpopstate = function () {
        history.pushState(null, "", location.href);
      };
    </script>

    <script>
      //cotacoes
      let selecionadas = [];

      function toggleDropdownCOTACOES() {
        const menu = document.getElementById("opcoes-cotacoes");
        menu.style.display =
          menu.style.display === "none" || menu.style.display === ""
            ? "block"
            : "none";
      }

      function selecionarOpcao(valor) {
        if (!selecionadas.includes(valor)) {
          selecionadas.push(valor);
          atualizarTags();
        }

        // Fecha o dropdown ap√≥s a sele√ß√£o
        document.getElementById("opcoes-cotacoes").style.display = "none";
      }

      function removerTag(valor) {
        selecionadas = selecionadas.filter((item) => item !== valor);
        atualizarTags();
      }

      function atualizarTags() {
        const container = document.getElementById("tags-cotacoes");
        container.innerHTML = "";
        selecionadas.forEach((valor) => {
          const tag = document.createElement("div");
          tag.className = "tag-cotacao";
          tag.innerHTML = `${valor} <span onclick="removerTag('${valor}')">√ó</span>`;
          container.appendChild(tag);
        });

        document.getElementById("cotacoesSelecionadas").value =
          selecionadas.join(",");
      }

      // Fechar dropdown ao clicar fora
      document.addEventListener("click", function (e) {
        const dropdown = document.getElementById("cotacoes-dropdown");
        if (!dropdown.contains(e.target)) {
          document.getElementById("opcoes-cotacoes").style.display = "none";
        }
      });
    </script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const btnReprocessar = document.getElementById("btnReprocessar");
        const btnEnviarModal = document.getElementById("btnEnviarModal");
        const mensagemModal = document.getElementById("mensagemModal");
        const modal = document.getElementById("modalPreview");
        const preview = document.getElementById("previewEmail");
        const form = document.querySelector("form");

        // ============================
        // üîÅ BOT√ÉO REPROCESSAR (PREVIEW R√ÅPIDO ‚Äì TEXTO PURO)
        // ============================
        if (btnReprocessar && modal && preview && form) {
          btnReprocessar.addEventListener("click", function () {
            const dados = new FormData(form);

            btnReprocessar.disabled = true;
            btnReprocessar.innerText = "Reprocessando...";

            preview.textContent = "Carregando pr√©-visualiza√ß√£o...";

            fetch("/preview-email", {
              method: "POST",
              body: dados,
            })
              .then((response) => response.text())
              .then((texto) => {
                preview.textContent = texto; // TEXTO PURO
                modal.style.display = "flex";

                btnReprocessar.disabled = false;
                btnReprocessar.innerText = "Reprocessar";
              })
              .catch(() => {
                preview.textContent = "Erro ao gerar pr√©-visualiza√ß√£o.";
                modal.style.display = "flex";

                btnReprocessar.disabled = false;
                btnReprocessar.innerText = "Reprocessar";
              });
          });
        }

        // ============================
        // ‚úâÔ∏è BOT√ÉO ENVIAR (PROCESSO COMPLETO + MENSAGENS EM ETAPAS)
        // ============================
        if (btnEnviarModal && mensagemModal && form) {
          btnEnviarModal.addEventListener("click", function () {
            const dados = new FormData(form);

            btnEnviarModal.disabled = true;
            btnEnviarModal.textContent = "Enviando...";

            mensagemModal.style.color = "#444";
            mensagemModal.textContent =
              "üì® E-mail enviado com sucesso. Aguarde um momento e n√£o feche a janela ainda.";

            fetch("/send-email", {
              method: "POST",
              body: dados,
            })
              .then((response) => {
                if (!response.ok) throw new Error();
                return response.json();
              })
              .then(() => {
                mensagemModal.style.color = "green";
                mensagemModal.textContent =
                  "‚úÖ Processo conclu√≠do. A janela pode ser fechada.";
              })
              .catch(() => {
                mensagemModal.style.color = "red";
                mensagemModal.textContent =
                  "‚ùå Erro ao enviar o e-mail. Tente novamente.";
                btnEnviarModal.disabled = false;
                btnEnviarModal.textContent = "Enviar E-mail";
              });
          });
        }
      });

      // ============================
      // ‚ùå FECHAR MODAL
      // ============================
      function fecharModal() {
        const modal = document.getElementById("modalPreview");
        modal.style.display = "none";

        const mensagemModal = document.getElementById("mensagemModal");
        if (mensagemModal) {
          mensagemModal.textContent = "";
          mensagemModal.style.color = "";
        }
      }
    </script>
  </body>
</html>
